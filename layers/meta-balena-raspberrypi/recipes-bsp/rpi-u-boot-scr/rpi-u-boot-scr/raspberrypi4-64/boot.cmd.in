setenv resin_kernel_load_addr ${kernel_addr_r}
setenv resin_tmp_loadaddr 0x10000000
run resin_set_kernel_root
if test "${resin_root_part}" = "${resin_roota}"; then setenv resin_root_label resin-rootA; else setenv resin_root_label resin-rootB; fi
if test "${bootparam_flasher}" = "flasher"; then setenv resin_kernel_root 'root=LABEL=flash-rootA'; else setenv resin_kernel_root root=LABEL=${resin_root_label}; fi
fdt addr ${fdt_addr}
fdt get value bootargs /chosen bootargs
run set_os_cmdline
env set bootargs "${os_cmdline} ${bootargs} ${resin_kernel_root}"
fdt rm /chosen bootargs
load ${resin_dev_type} ${resin_dev_index}:${resin_root_part} ${resin_tmp_loadaddr} /boot/@@KERNEL_IMAGETYPE@@
unzip ${fileaddr} ${resin_kernel_load_addr}
@@KERNEL_BOOTCMD@@ ${resin_kernel_load_addr} - ${fdt_addr}
